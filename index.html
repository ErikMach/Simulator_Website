<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Simulator</title>
    <meta charset="UTF-8">
<!-- CSP WHEN NEEDED
    <meta http-equiv="Content-Security-Policy" content="default-src 'self';">
-->
    <link rel="stylesheet" type="text/css" href="./css/index.css"/>
    <link rel="icon" href="./res/icon.webp"/>
    <link rel="prefetch" href="./res/icon.webp"/>
    <script src="./js/react.development.js"></script>
    <script src="./js/react-dom.development.js"></script>
  </head>
  <style>
:root {

}


:root {
  --color-canvas-subtle: #f6f8fa;
  --color-border-muted: #d8dee4;
  --logo-green: #7fbe42;
  --stone-blue: #68829f;
  --blanched-almond: #fff0d9;
}

* {
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";
  line-height: 1.5;
  font-size: 24px;
  font-weight: 400;
  user-select: none;
}

body {
  margin: 0;
  padding: 0;
}

.signInBox {
  display: flex;
  flex-flow: column nowrap;
  justify-content: center;
  align-items: center;
  width: 340px;
  height: 100%;
  color: var(--color-border-muted);
}

.signInBox > img {
  height: 150px;
  width: auto;
}

.formBox {
  display: flex;
  flex-flow: column nowrap;
  justify-content: space-around;
  align-items: stretch;
  width: 340px;
  height: 270px;
  padding: 20px;
  font-size: 14px;
  border-radius: 6px;
  background-color: var(--color-canvas-subtle);
  border: 1px solid var(--color-border-muted);
  box-shadow: 0 0 3px #233e5c;
}
.formBox > * {
  border-radius: 6px;
  font-size: 20px;
  color: black;
}
.formBox > input {
  padding: 3px;
}

.formBox > button {
  padding: 4px;
  color: white;
  font-weight: 500;
  background-color: var(--logo-green);
  cursor: pointer;
}

#passwordErrorMsg {
  position: relative;
  color: red;
  margin: 0;
  font-size: 10;
  height: 0;
  transition: height 0.4s;
  overflow: hidden;
}

#loginPage {
  justify-content: center;
  align-items: center;
  background-color: var(--stone-blue);
}

#activityPage {
  background-color: #fff6c1;
}

.page {
  position: relative;
  width: 100vw;
  height: 100vh;
  top: 0;
  left: 0;
  display: none;
  flex-flow: row wrap;
  justify-content: flex-start;
  align-items: flex-start;
  transition: opacity 0.5s;
}

.transparent {
  opacity: 0 !important;
}
.display {
  display: flex !important;
}
.pHeight {
  height: 1.5em !important;
}

.card {
  position: relative;
  width: 250px;
  height: 180px;
  top: 0;
  margin: 25px;
  background-color: var(--blanched-almond);
  border: 3px solid gold;
  border-radius: 25px;
  overflow: hidden;
  transition: 0.4s;
}
.card:hover {
  cursor: pointer;
  top: -5px;
  box-shadow: 0 4px 3px var(--stone-blue);
}
.card:active {
  cursor: pointer;
  top: 0;
  box-shadow: none;
}
.card > h3 {
  position: relative;
  position: absolute;
  top: 50%;
  width: 100%;
  padding: 15px 0;
  text-align: center;
  background-color: var(--color-border-muted);
}
  </style>
  <body>
<!-- Needs constant topBar (logout, profile, ...) -->
    <div class="page currentPage display" id="loginPage"></div>
    <div class="page" id="activityPage"></div>

    <div class="page" id="explorePage"></div>
    <div class="page" id="simulatorPage"></div>
    <div class="page" id="miniProjectsPage"></div>
    <div class="page" id="environmentsPage"></div>


<script>
const e = React.createElement;
let userType = "student";
const activityCards = {
  "commercialUser": ["Explore", "Simulator", "Mini Projects", "Environments"],
  "student": ["Explore", "Simulator", "Mini Projects", "Environments"],
  "teacher": ["Explore", "Teaching Material", "Simulator", "Mini Projects", "Environments"]
};

let cheese = false;

class card extends React.Component {
  constructor(props) {
    super(props);
    this.state = {apple: cheese};
  }
  componentDidMount() {
//    this.int = setInterval(() => this.tick(), 1000);
  }
  componentWillUnmount() {
    clearInterval(this.int);
  }
  tick() {
    this.setState((state, props) => ({apple: cheese}));
  }
  render() {
    return e('div', {id: `${this.props.title}Card`, className: "card", style: {backgroundImage: `url(./res/${this.props.title.split(/\s/g).join('')}.webp)`}, onClick: () => {page(`${pascalMaBoi(this.props.title)}Page`)}}, [
      e('h3', {key: 10}, `${this.props.title}`)
    ]);
  }
}

const pascalMaBoi = (str) => {
  const arr = str.split(/\s/g);
  arr[0] = arr[0].toLowerCase();
  return arr.join('');
};

const components = {};
components.login = () => {
  return e('div', {className: "signInBox"}, [
    e('img', {key:1, src: "./res/icon.webp"}, null),
    e('h1', {key: 2}, "Sign in to EdgUSim"),
    e('div', {key:3, className: "formBox"}, [
      e('label', {key: 4}, "Username"),
      e('input', {key: 5, placeholder: "", type: "text"}, null),
      e('label', {key: 6, htmlFor: "passwordIn"}, "Password"),
      e('input', {key: 7, id: "passwordIn", placeholder: "", type: "password"}, null),
      e('p', {key: 8, id: "passwordErrorMsg"}, "Sorry, wrong password"),
      e('button', {key: 9, onClick: signIn}, "Sign In")
    ])
  ]);
};
components.activity = activityCards[userType].map(ic => e(card, {title: ic, key: ic}, null));
components.explore = [];

const configureSite = () => {
  console.log(components);
  ReactDOM.render(components.login(), document.getElementById('loginPage'));
};

const page = (newPageId) => {
console.log('Redirecting to:', newPageId);
  document.getElementsByClassName('currentPage')[0].classList.add('transparent');
  document.getElementById(newPageId).classList.add('transparent', 'display');
  setTimeout(() => {
    ReactDOM.render(null, document.getElementsByClassName('currentPage')[0]);
    ReactDOM.render(components[newPageId.slice(0,-4)], document.getElementById(newPageId));
    document.getElementsByClassName('currentPage')[0].classList.remove('display', 'currentPage');
    document.getElementById(newPageId).classList.remove('transparent');
    document.getElementById(newPageId).classList.add('currentPage');
  }, 500);
};

const signIn = () => {
  if (!verifyPassword()) {wrongPassword(); return;};
  console.log("Password Correct");
  page('activityPage');
};

const verifyPassword = () => {
  return (document.getElementById('passwordIn').value === "") ? true : false;
};
const wrongPassword = () => {
  document.getElementById('passwordErrorMsg').classList.add('pHeight');
};

const activate = (newPageId) => {
  page(newPageId);
};

configureSite();
</script>

  </body>
</html>